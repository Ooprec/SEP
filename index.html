<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./styles/layout.css">
    <link rel="stylesheet" href="./styles/animations.css">
    <title>Student Election Project</title>
</head>
<body class="light">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <div id="main-page" class="light">
        
        <h1 id="header" class="maroon" >
            <img id = "mayo" src="./assets/logo.png" alt="logo">
            <p id="header-text" class="title-anim">Student Elections</p> 
            
        </h1>


        <!--start collapsible-->
        <label id="collapsible-label" class="collapsible-label maroon" for="collapsible">Upload Election</label>
        <button type="button" id="collapsible" class="collapsible maroon">Upload Election</button>
        <div class="collapsible-content light">
            <div id="instruct-div" class="light">
                <label for="instructions" class="custom-overlay-button light">Instructions</label>
                <button id="instructions" onclick="window.location.href='instructions.html'" class="hidden-button"></button>
            </div>
            
        <form action="" id="uploadForm" class="light">
            <div id="inputs" class="light">
                <label for="csv" id="upload-csv-label" class="input-label">Upload CSV:</label>
                <label for="csv" id="replacement-button" class="custom-overlay-button">Choose File...</label>
                <input type="file" id="csv" accept=".csv" required> <br><br>
                
                <label for="csv-name" class="input-label light">Election Name: </label>
                <input type="text" id="csv-name" class="light" placeholder="" minlength="5">

                <br><br>
                <label for="submit" class="custom-overlay-button" onclick="">Submit</label>
                <button type="submit" class="hidden-button" id="submit" onclick=""></button>

                </div>
            </form>

            <div id="Ubar-container">
                <label for="Ubar-bar" id="Ubar-text">_</label>
                
                <div id="Ubar-border">
                    <div id="Ubar-bar" class="unstarted"></div>
                </div>
            </div>

        <div class="thin-bar maroon"></div>

         </div> <!--end collapsible-->

        <br>

        <div id="post-form">
            <select id="csv-options" class="light" onchange=""></select></select>
            <label for="download" class="custom-overlay-button">Run</label>
            <!-- <button id="download" onclick="sessionStorage.setItem('on-second', JSON.stringify(false));document.getElementById('chartDiv').innerHTML = ''; loadFromDatabase();vote(JSON.parse(sessionStorage.getItem('allVotes'))); document.getElementById('Lbar-container').click(); document.getElementById('Lbar-container').click()" class="hidden-button" ></button> -->
            
            <button id="download" onclick="document.dispatchEvent(new CustomEvent('displayRounds'))" class="hidden-button" ></button>

            <label for="thingss" class="custom-overlay-button">Destroy Votes</label>
            <button id="thingss" onclick="destroyVotes()" class="hidden-button">Delete Project</button>

        </div>

        <div id="Lbar-container">
            <label for="Lbar-bar" id="Lbar-text">Test</label>
            
            <div id="Lbar-border">
                <div id="Lbar-bar" class="unstarted"></div>
            </div>
            
        </div> <br>
        <div id="switch-div">
            <p id="switch-p-l">Rank Choice Voting</p>
            <label id="toggle-switch" class="switch">
                <input type="checkbox" id="important-part">
                <span class="slider round"></span>
            </label>
            <p id="switch-p-r" >Point-Based Voting</p>
        </div>
        <div id="other" onclick=""></div>

    </div>
    <div id="point_graph" style="display: none" data-election="None"></div>


<div id = "chartDiv" style="display: grid" data-election="None"></div>

    </div>
    <br>
    


    <!--Links layout to upload and imports the csv database function-->
    <script type="module" src="./scripts/animations.js" defer></script>
    <script type="module" src="./scripts/upload.js" defer></script>
    <script type="module" src="./scripts/vote.js" defer></script>
    <script type="module">
        import * as uploadjs from "./scripts/upload.js";
        import * as votejs from "./scripts/vote.js";
        import * as optjs from "./scripts/optimizations.js";
        window.importCSVToDatabase = uploadjs.importCSVToDatabase;
        window.loadFromDatabase = votejs.loadFromDatabase;
        window.getCollectionList = uploadjs.getCollectionList;
        window.vote = votejs.vote;
        window.count = votejs.count;
        window.checkLocal = optjs.checkLocal;
        window.destroyVotes = uploadjs.destroyVotes;
        window.removeWinner = votejs.removeWinner;
        window.point = votejs.point;
        window.updateVote = votejs.updateVote;


        await getCollectionList();
        await loadFromDatabase();
        await vote(JSON.parse(sessionStorage.getItem('allVotes')), JSON.parse(sessionStorage.getItem('holder')));
      </script>
</body>
</html>

</script>